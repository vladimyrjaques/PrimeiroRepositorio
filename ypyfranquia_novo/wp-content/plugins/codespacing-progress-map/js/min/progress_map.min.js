function cspm_load_map_options(light_map,latLng,zoom){var latlng=null!=latLng?latLng.split(","):progress_map_vars.center.split(","),zoom_value=null!=zoom?parseInt(zoom):parseInt(progress_map_vars.zoom),max_zoom_value=parseInt(progress_map_vars.max_zoom),min_zoom_value=parseInt(progress_map_vars.min_zoom),map_draggable="true"==progress_map_vars.map_draggable?!0:!1,zoom_on_doubleclick="true"==progress_map_vars.zoom_on_doubleclick?!0:!1,default_options={center:[latlng[0],latlng[1]],zoom:zoom_value,maxZoom:max_zoom_value,minZoom:min_zoom_value,scrollwheel:eval(progress_map_vars.scrollwheel),panControl:eval(progress_map_vars.panControl),panControlOptions:{position:google.maps.ControlPosition.RIGHT_TOP},mapTypeControl:eval(progress_map_vars.mapTypeControl),mapTypeControlOptions:{position:google.maps.ControlPosition.TOP_RIGHT,mapTypeIds:[google.maps.MapTypeId.ROADMAP,google.maps.MapTypeId.SATELLITE,google.maps.MapTypeId.TERRAIN,google.maps.MapTypeId.HYBRID]},streetViewControl:eval(progress_map_vars.streetViewControl),streetViewControlOptions:{position:google.maps.ControlPosition.RIGHT_TOP},draggable:map_draggable,disableDoubleClickZoom:zoom_on_doubleclick};if("true"==progress_map_vars.zoomControl&&"default"==progress_map_vars.zoomControlType)var zoom_options={zoomControl:!0,zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL}};else var zoom_options={zoomControl:!1};var map_options=jQuery.extend({},default_options,zoom_options);return map_options}function cspm_initial_map_style(e,s){if("custom_style"==e&&0==s)var a={mapTypeId:google.maps.MapTypeId.ROADMAP};else if("custom_style"==e)var a={mapTypeId:"custom_style"};else if("ROADMAP"==e)var a={mapTypeId:google.maps.MapTypeId.ROADMAP};else if("SATELLITE"==e)var a={mapTypeId:google.maps.MapTypeId.SATELLITE};else if("TERRAIN"==e)var a={mapTypeId:google.maps.MapTypeId.TERRAIN};else if("HYBRID"==e)var a={mapTypeId:google.maps.MapTypeId.HYBRID};return a}function cspm_new_pin_object(e,s,a,t,r,o,i,_,n){post_lat_lng_coords[o][s]=a+"_"+t,post_ids_and_categories[o]["post_id_"+s]={},post_ids_and_child_status[o][a+"_"+t]=n;var p=""!=r?r.split(","):"";post_ids_and_categories[o]["post_id_"+s][0]=p;var c="";if("customize"==progress_map_vars.defaultMarker){var l=i,m="true"==progress_map_vars.retinaSupport?parseInt(_.split("x")[0])/2:parseInt(_.split("x")[0]),u="true"==progress_map_vars.retinaSupport?parseInt(_.split("x")[1])/2:parseInt(_.split("x")[1]),d=u/2,g=m/2,f=null;"auto"==progress_map_vars.marker_anchor_point_option?f=new google.maps.Point(g,d):"manual"==progress_map_vars.marker_anchor_point_option&&(f="true"==progress_map_vars.retinaSupport?new google.maps.Point(progress_map_vars.marker_anchor_point.split(",")[0]/2,progress_map_vars.marker_anchor_point.split(",")[1]/2):new google.maps.Point(progress_map_vars.marker_anchor_point.split(",")[0],progress_map_vars.marker_anchor_point.split(",")[1])),c=new google.maps.MarkerImage(l,null,null,f,new google.maps.Size(m,u))}return pin_object={latLng:[a,t],tag:"post_id__"+s,id:s+"_"+n,options:{optimized:!1,icon:c,id:s,post_id:s,is_child:n}}}function cspm_clustering(e,s,a){var t,r=e.gmap3("get");small_cluster_size=progress_map_vars.small_cluster_size,medium_cluster_size=progress_map_vars.medium_cluster_size,big_cluster_size=progress_map_vars.big_cluster_size;var o=parseInt(progress_map_vars.max_zoom);return e.gmap3({get:{name:"marker",all:!0,callback:function(i){if(i&&"undefined"!=typeof MarkerClusterer){t=new MarkerClusterer(r,i,{gridSize:parseInt(progress_map_vars.grid_size),styles:[{url:progress_map_vars.small_cluster_icon,height:small_cluster_size.split("x")[0],width:small_cluster_size.split("x")[1],textColor:progress_map_vars.cluster_text_color,textSize:11,fontWeight:"normal",fontFamily:"sans-serif"},{url:progress_map_vars.medium_cluster_icon,height:medium_cluster_size.split("x")[0],width:medium_cluster_size.split("x")[1],textColor:progress_map_vars.cluster_text_color,textSize:13,fontWeight:"normal",fontFamily:"sans-serif"},{url:progress_map_vars.big_cluster_icon,height:big_cluster_size.split("x")[0],width:big_cluster_size.split("x")[1],textColor:progress_map_vars.cluster_text_color,textSize:15,fontWeight:"normal",fontFamily:"sans-serif"}],zoomOnClick:!0,maxZoom:o,minimumClusterSize:2,averageCenter:!0,ignoreHidden:!0,title:progress_map_vars.cluster_text});var _;google.maps.event.addListener(t,"clusterclick",function(t){var i=r.getZoom(),n=Math.pow(2,i),p=new google.maps.LatLng(r.getBounds().getNorthEast().lat(),r.getBounds().getSouthWest().lng()),c=r.getProjection().fromLatLngToPoint(p),l=r.getProjection().fromLatLngToPoint(t.center_),m=new google.maps.Point(Math.floor((l.x-c.x)*n),Math.floor((l.y-c.y)*n)),u=e.position(),d=0;if(i>=o||"TERRAIN"==progress_map_vars.initial_map_style&&i>=15){var g=t.getMarkers(),f=[];if("undefined"!=typeof g){for(var v=0;v<g.length;v++)1==g[v].visible&&(d++,f.push(g[v].id));jQuery("div.cluster_posts_widget_"+s).html('<div class="blue_cloud"></div>'),d>0?(jQuery("div.cluster_posts_widget_"+s).removeClass("flipOutX"),jQuery("div.cluster_posts_widget_"+s).addClass("cspm_animated flipInX").css("display","block"),jQuery("div.cluster_posts_widget_"+s).css({left:m.x+u.left+40+"px",top:m.y+u.top-32+"px"}),_&&4!=_.readystate&&_.abort(),_=jQuery.post(progress_map_vars.ajax_url,{action:"cspm_load_clustred_markers_list",post_ids:f,light_map:a},function(e){jQuery("div.cluster_posts_widget_"+s).html(e),"function"==typeof jQuery("div.cluster_posts_widget_"+s).mCustomScrollbar&&jQuery("div.cluster_posts_widget_"+s).mCustomScrollbar({autoHideScrollbar:!0,mouseWheel:{enable:!0,preventDefault:!0},theme:"dark-thin"})}),jQuery("div.cluster_posts_widget_"+s+" ul li").livequery("click",function(){var e=jQuery(this).attr("id"),a=jQuery("li#"+s+"_list_items_"+e).attr("value");cspm_call_carousel_item(jQuery("ul#codespacing_progress_map_carousel_"+s).data("jcarousel"),a),cspm_carousel_item_hover_style("li.carousel_item_"+a+"_"+s,s)})):jQuery("div.cluster_posts_widget_"+s).css({display:"none"})}cspm_zoom_in_and_out(e)}setTimeout(function(){i=r.getZoom(),"TERRAIN"!=progress_map_vars.initial_map_style&&i>o&&r.setZoom(o)},100)})}}}}),t}function cspm_zoom_in_and_out(e){var s=e.gmap3("get");s.setZoom(s.getZoom()-1),s.setZoom(s.getZoom()+1)}function cspm_simple_clustering(e){var s=e.gmap3("get");if("undefined"!=typeof MarkerClusterer){new MarkerClusterer(s)}cspm_zoom_in_and_out(e)}function cspm_ajax_item_details(e,s){jQuery.post(progress_map_vars.ajax_url,{action:"cspm_load_carousel_item",post_id:e,items_view:progress_map_vars.items_view},function(a){jQuery("li#"+s+"_list_items_"+e).addClass("cspm_animated fadeIn").html(a)})}function cspm_animate_marker(e,s,a){e.gmap3({get:{name:"marker",tag:"post_id__"+a,callback:function(t){if("undefined"!=typeof t&&1==t.visible){var r=t.is_child,o="div.cspm_infobox_container.infobox_"+a+"[data-is-child="+r+"]";if(jQuery("div.cspm_infobox_container").removeClass("cspm_current_bubble"),"pulsating_circle"==progress_map_vars.markerAnimation){var i=e.gmap3("get"),_=Math.pow(2,i.getZoom()),n=new google.maps.LatLng(i.getBounds().getNorthEast().lat(),i.getBounds().getSouthWest().lng()),p=i.getProjection().fromLatLngToPoint(n),c=i.getProjection().fromLatLngToPoint(t.position),l=new google.maps.Point(Math.floor((c.x-p.x)*_),Math.floor((c.y-p.y)*_)),m=e.position();jQuery("div#pulsating_holder."+s+"_pulsating").css({display:"block",left:l.x+m.left-15+"px",top:l.y+m.top-18+"px"}),setTimeout(function(){jQuery("div#pulsating_holder."+s+"_pulsating").css("display","none"),jQuery(o).addClass("cspm_current_bubble")},1500)}else"bouncing_marker"==progress_map_vars.markerAnimation?(t.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){t.setAnimation(null),jQuery(o).addClass("cspm_current_bubble")},1500)):"flushing_infobox"==progress_map_vars.markerAnimation&&(jQuery("div.cspm_infobox_container").removeClass("cspm_animated flash"),setTimeout(function(){jQuery(o).addClass("cspm_animated flash"),jQuery(o).one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){jQuery(o).removeClass("flash")})},600))}}}})}function cspm_zoom_in(e,s){e.click(function(){var e=jQuery(s).gmap3("get"),a=e.getZoom();a<progress_map_vars.max_zoom&&e.setZoom(a+1),jQuery("div[class^=cluster_posts_widget]").removeClass("flipInX"),jQuery("div[class^=cluster_posts_widget]").addClass("cspm_animated flipOutX")})}function cspm_zoom_out(e,s){e.click(function(){var e=jQuery(s).gmap3("get"),a=e.getZoom();a>progress_map_vars.min_zoom&&e.setZoom(a-1),jQuery("div[class^=cluster_posts_widget]").removeClass("flipInX"),jQuery("div[class^=cluster_posts_widget]").addClass("cspm_animated flipOutX")})}function cspm_init_carousel(carousel_size,map_id){var carousel_id=map_id;if("true"!=progress_map_vars.show_carousel||"fullscreen-map"==map_layout[map_id]||"fit-in-map"==map_layout[map_id])return!1;var vertical_value=!1,dimension="listview"==progress_map_vars.items_view?progress_map_vars.horizontal_item_width:progress_map_vars.vertical_item_width;if("mr-cl"==map_layout[map_id]||"ml-cr"==map_layout[map_id]||"map-tglc-right"==map_layout[map_id]||"map-tglc-left"==map_layout[map_id])var vertical_value=!0,dimension="listview"==progress_map_vars.items_view?progress_map_vars.horizontal_item_height:progress_map_vars.vertical_item_height;var size={},auto_scroll_option={};if(""!=progress_map_vars.number_of_items)var size={size:parseInt(progress_map_vars.number_of_items)};else if(null!=carousel_size)var size={size:parseInt(carousel_size)};var default_options={scroll:eval(progress_map_vars.carousel_scroll),wrap:progress_map_vars.carousel_wrap,auto:eval(progress_map_vars.carousel_auto),initCallback:cspm_carousel_init_callback,itemFallbackDimension:parseInt(dimension),itemLoadCallback:cspm_carousel_itemLoadCallback,rtl:eval(progress_map_vars.carousel_mode),animation:progress_map_vars.carousel_animation,easing:progress_map_vars.carousel_easing,vertical:vertical_value};if(eval(progress_map_vars.carousel_auto)>0)var auto_scroll_option={itemFirstInCallback:{onAfterAnimation:cspm_carousel_item_request}};else var auto_scroll_option={itemFirstInCallback:cspm_carousel_itemFirstInCallback};var carousel_options=jQuery.extend({},default_options,size,auto_scroll_option);jQuery("ul#codespacing_progress_map_carousel_"+carousel_id).jcarousel(carousel_options)}function cspm_carousel_itemFirstInCallback(e,s,a,t){var r=e.container.context.id.split("codespacing_progress_map_carousel_")[1];if("prev"==t||"next"==t){var o=s.value;cspm_carousel_item_hover_style("li.carousel_item_"+o+"_"+r,r)}return!1}function cspm_carousel_itemLoadCallback(e){for(var s=e.container.context.id.split("codespacing_progress_map_carousel_")[1],a=parseInt(e.first);a<=parseInt(e.last);a++){var t=jQuery("li.jcarousel-item-"+a+"[class*=_"+s+"]").attr("data-post-id");jQuery("li#"+s+"_list_items_"+t).has("div.cspm_spinner").length&&cspm_ajax_item_details(t,s)}}function cspm_carousel_init_callback(e){var s=e.container.context.id.split("codespacing_progress_map_carousel_")[1],a=s;"true"==progress_map_vars.scrollwheel_carousel&&jQuery("ul#codespacing_progress_map_carousel_"+s).mousewheel(function(s,a){return a>0?(e.prev(),setTimeout(function(){cspm_carousel_item_request(e,0)},600),!1):0>a?(e.next(),setTimeout(function(){cspm_carousel_item_request(e,0)},600),!1):void 0}),"true"==progress_map_vars.touchswipe_carousel&&"function"==typeof jQuery("ul#codespacing_progress_map_carousel_"+s).swipe&&jQuery("ul#codespacing_progress_map_carousel_"+s).swipe({swipe:function(s,t){if("mu-cd"==map_layout[a]||"md-cu"==map_layout[a]||"m-con"==map_layout[a]||"fullscreen-map-top-carousel"==map_layout[a]||"fit-in-map-top-carousel"==map_layout[a]){if("left"==t)return e.next(),setTimeout(function(){cspm_carousel_item_request(e,0)},600),!1;if("right"==t)return e.prev(),setTimeout(function(){cspm_carousel_item_request(e,0)},600),!1}else if("ml-cr"==map_layout[a]||"mr-cl"==map_layout[a]){if("up"==t)return e.next(),setTimeout(function(){cspm_carousel_item_request(e,0)},600),!1;if("down"==t)return e.prev(),setTimeout(function(){cspm_carousel_item_request(e,0)},600),!1}},threshold:0}),e.clip.hover(function(){e.stopAuto()},function(){e.startAuto()}),e.buttonNext.bind("click",function(){setTimeout(function(){cspm_carousel_item_request(e,0)},600)}),e.buttonPrev.bind("click",function(){setTimeout(function(){cspm_carousel_item_request(e,0)},600)})}function cspm_carousel_item_request(carousel,item_value){var map_id=carousel.container.context.id.split("codespacing_progress_map_carousel_")[1],plugin_map=jQuery("div#codespacing_progress_map_div_"+map_id),firstItem=parseInt(carousel.first),carouselItemValue=eval(progress_map_vars.carousel_auto)>0?0:parseInt(item_value);0!=carouselItemValue&&carouselItemValue!=firstItem&&(firstItem=carouselItemValue);var overlay_id=jQuery(".jcarousel-item-"+firstItem).attr("class").split(" ")[0];if(overlay_id){var item_latlng=jQuery("li#"+map_id+"_list_items_"+overlay_id).attr("name");if(item_latlng&&"undefined"!=typeof item_latlng){var split_item_latlng=item_latlng.split("_"),this_lat=split_item_latlng[0].replace(/\"/g,""),this_lng=split_item_latlng[1].replace(/\"/g,"");cspm_carousel_item_hover_style("li#"+map_id+"_list_items_"+overlay_id,map_id),cspm_center_map_at_point(plugin_map,this_lat,this_lng,"zoom"),setTimeout(function(){cspm_animate_marker(plugin_map,map_id,overlay_id)},200)}}}function cspm_call_carousel_item(e,s){return e.scroll(jQuery.jcarousel.intval(s)),!1}function cspm_carousel_item_hover_style(e,s){jQuery("li[id^="+s+"_list_items_]").removeClass("cspm_carousel_first_item").css({"background-color":progress_map_vars.items_background}),jQuery(e).addClass("cspm_carousel_first_item").css({"background-color":progress_map_vars.items_hover_background})}function cspm_rewrite_carousel(e,s,a){if("yes"!=s||"true"!=progress_map_vars.show_carousel||"fullscreen-map"==map_layout[e]||"fit-in-map"==map_layout[e])return a.length;var t=jQuery("ul#codespacing_progress_map_carousel_"+e).data("jcarousel");if("undefined"!=typeof t){t.reset();var r=cspm_object_size(a);"listview"==progress_map_vars.items_view?(item_width=parseInt(progress_map_vars.horizontal_item_width),item_height=parseInt(progress_map_vars.horizontal_item_height),item_css=progress_map_vars.horizontal_item_css,items_background=progress_map_vars.items_background):"gridview"==progress_map_vars.items_view&&(item_width=parseInt(progress_map_vars.vertical_item_width),item_height=parseInt(progress_map_vars.vertical_item_height),item_css=progress_map_vars.vertical_item_css,items_background=progress_map_vars.items_background);for(var o=0,i=0;r>i;i++){var _=a[i],n=post_ids_and_child_status[e][post_lat_lng_coords[e][_]],p="";p='<li id="'+e+"_list_items_"+_+'" class="'+_+" carousel_item_"+(i+1)+"_"+e+' cspm_border_radius cspm_border_shadow" data-map-id="'+e+'" data-is-child="'+n+'" name="'+post_lat_lng_coords[e][_]+'" value="'+(i+1)+'" data-post-id="'+_+'" style="width:'+item_width+"px; height:"+item_height+"px; background-color:"+items_background+"; "+item_css+'">',p+='<div class="cspm_spinner"></div>',p+="</li>",t.add(i+1,p),o++}return cspm_init_carousel(r,e),o++}}function cspm_fullscreen_map(e){var s=window.innerWidth,a=window.innerHeight;jQuery("div.codespacing_progress_map_area[data-map-id="+e+"]").css({height:a,width:s})}function cspm_carousel_width(e){var s=jQuery("div.codespacing_progress_map_area[data-map-id="+e+"]").width();s=parseInt(s-40);var a=parseInt(-0-s/2);jQuery("div.codespacing_progress_map_carousel_on_top[data-map-id="+e+"]").css({width:s,"margin-left":a+"px"})}function cspm_fitIn_map(e){var s=jQuery("div.codespacing_progress_map_area[data-map-id="+e+"]").parent().height();0==s&&(s=progress_map_vars.layout_fixed_height),jQuery("div.codespacing_progress_map_area[data-map-id="+e+"]").css({height:s})}function cspm_set_markers_visibility(e,s,a,t,r,o,i){return 1==i?null!=a?e.gmap3({get:{name:"marker",all:!0,callback:function(e){e&&jQuery.each(e,function(e,s){"undefined"!=typeof s.post_id&&"user_location"!=s.post_id&&jQuery.inArray(a,r["post_id_"+s.post_id][0])>-1&&("function"==typeof s.setVisible&&s.setVisible(!0),-1===jQuery.inArray(parseInt(s.post_id),o)&&(o[t]=parseInt(s.post_id),t++)),"user_location"==s.post_id&&"function"==typeof s.setVisible&&s.setVisible(!0)})}}}):e.gmap3({get:{name:"marker",all:!0,callback:function(e){e&&jQuery.each(e,function(e,s){"function"==typeof s.setVisible&&jQuery.inArray(parseInt(s.post_id),o)>-1&&s.setVisible(!0)})}}}):e.gmap3({get:{name:"marker",all:!0,callback:function(e){e&&jQuery.each(e,function(e,s){"function"==typeof s.setVisible&&s.setVisible(!0),"undefined"!=typeof s.post_id&&"user_location"!=s.post_id&&(o[t]=parseInt(s.post_id)),t++})}}}),o}function cspm_get_distance(e,s,a,t,r){var o="metric"==r?6380:3964.34820496;return distance=Math.acos(Math.sin(cspm_deg2rad(a))*Math.sin(cspm_deg2rad(e))+Math.cos(cspm_deg2rad(a))*Math.cos(cspm_deg2rad(e))*Math.cos(cspm_deg2rad(t)-cspm_deg2rad(s)))*o}function cspm_geolocate(e,s,a,t,r,o,i){var _=e.gmap3("get");_.getZoom();e.gmap3({getgeoloc:{callback:function(_){_?e.gmap3({map:{options:{center:_,zoom:parseInt(o)},onces:{tilesloaded:function(){a&&setTimeout(function(){e.gmap3({marker:{latLng:_,tag:"cspm_user_marker_"+s,options:{icon:t,post_id:"user_location"}},circle:{options:{center:_,radius:parseInt(1e3*r),fillColor:progress_map_vars.fillColor,fillOpacity:progress_map_vars.fillOpacity,strokeColor:progress_map_vars.strokeColor,strokeOpacity:progress_map_vars.strokeOpacity,strokeWeight:parseInt(progress_map_vars.strokeWeight),editable:!1}}})},500)}}}}):i&&alert(progress_map_vars.geoErrorTitle+"\n\n"+progress_map_vars.geoErrorMsg)}}})}function cspm_get_user_marker(e,s){e.gmap3({get:{name:"marker",tag:"cspm_user_marker_"+s,callback:function(e){return e?e:void 0}}})}function cspm_is_panorama_active(e){var s=e.gmap3("get");if("function"==typeof s.getStreetView){var a=s.getStreetView();return a.getVisible()}return!1}function cspm_center_map_at_point(e,s,a,t){var r=e.gmap3("get"),o=r.getZoom(),i=new google.maps.LatLng(s,a);"zoom"==t&&o!=parseInt(carousel_map_zoom)?r.setZoom(parseInt(carousel_map_zoom)):"resize"==t&&google.maps.event.trigger(r,"resize"),r.panTo(i),r.setCenter(i)}function cspm_pan_map_to_fit_infobox(e,s,a){var t=e.gmap3("get"),r="div#codespacing_progress_map_div_"+s,o=(jQuery(r).width(),jQuery(r).height(),jQuery(r).position().top),i=(jQuery(r).position().left,jQuery(a.selector).width(),jQuery(a.selector).height()),_=jQuery(a.selector).position().top;jQuery(a.selector).position().left;if(_>o){var n=0,p=-(i/2);t.panBy(n,p)}}function cspm_is_bounds_contains_marker(e,s,a){var t=e.gmap3("get"),r=new google.maps.LatLng(s,a);return t.getBounds().contains(r)}function cspm_draw_multiple_infoboxes(e,s,a,t,r){e.gmap3({get:{name:"marker",all:!0,callback:function(o){for(var i=0;i<o.length;i++){var _=o[i],n=parseInt(o[i].post_id);if(""!=n&&"user_location"!=n&&!isNaN(n)){var p=o[i].position,c="undefined"==typeof o[i].icon||"undefined"==typeof o[i].icon.size||"undefined"==typeof o[i].icon.size.height?38:o[i].icon.size.height,l=o[i].is_child,m=p.lat(),u=p.lng();if(cspm_is_bounds_contains_marker(e,m,u)&&null!=o[i].getMap()&&1==o[i].visible){var d=jQuery("div.infobox_"+n+".cspm_infobox_"+s+"[data-is-child="+l+"]");if(jQuery.contains(document.body,d[0]))cspm_infobox_set_position(e,d,p,c,_);else{var d=a;d=d.split('<div class="cspm_infobox_container cspm_border_shadow cspm_infobox_multiple cspm_infobox_'+s+" "+t),d=jQuery('<div data-is-child="'+l+'" class="cspm_infobox_container cspm_border_shadow cspm_infobox_multiple cspm_infobox_'+s+" "+t+" infobox_"+n+d[1]),jQuery(e.selector).parent().append(d),cspm_infobox_set_position(e,d,p,c,_),cspm_bubbles[s].push(n),cspm_child_markers[s].push(l),cspm_requests[s].push(jQuery.post(progress_map_vars.ajax_url,{action:"cspm_infobox_content",post_id:n,infobox_type:t,map_id:s,status:"cspm_infobox_multiple",carousel:r}))}}else jQuery("div.infobox_"+n+".cspm_infobox_"+s+"[data-is-child="+l+"]").fadeOut()}if(i==o.length-1&&cspm_bubbles[s].length>0){var g=jQuery.when.apply(jQuery,cspm_requests[s]);g.done(function(){1==cspm_requests[s].length?"success"==arguments[1]&&jQuery("div.infobox_"+cspm_bubbles[s][0]+".cspm_infobox_"+s+"[data-is-child="+cspm_child_markers[s][0]+"]").html(arguments[0]):cspm_requests[s].length>1&&jQuery.each(arguments,function(e,a){a.length>0&&"success"==a[1]&&jQuery("div.infobox_"+cspm_bubbles[s][e]+".cspm_infobox_"+s+"[data-is-child="+cspm_child_markers[s][e]+"]").html(a[0])})})}}}}})}function cspm_draw_single_infobox(e,s,a,t,r,o,i){var _=parseInt(r.post_id),n="undefined"==typeof r.icon||"undefined"==typeof r.icon.size||"undefined"==typeof r.icon.size.height?38:r.icon.size.height,p=a.attr("data-post-id");if(p!=_){var c='<div class="blue_cloud"></div><div class="cspm_arrow_down '+t+'"></div>';a.html(c),o&&4!=o.readystate&&o.abort(),o=jQuery.post(progress_map_vars.ajax_url,{action:"cspm_infobox_content",post_id:_,infobox_type:t,map_id:s,status:"cspm_infobox_single",carousel:i},function(e){a.html(e)})}return a.attr("data-post-id",_),cspm_infobox_set_position(e,a,r.position,n,r),o}function cspm_set_single_infobox_position(e,s){if(s.is(":visible")){var a=s.attr("data-post-id");e.gmap3({get:{name:"marker",tag:"post_id__"+a,callback:function(a){var t="undefined"==typeof a.icon||"undefined"==typeof a.icon.size||"undefined"==typeof a.icon.size.height?38:a.icon.size.height;cspm_infobox_set_position(e,s,a.position,t,a),setTimeout(function(){(null==a.getMap()||0==a.visible)&&(s.addClass("cspm_animated fadeOutUp"),s.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){s.hide().removeClass("cspm_animated fadeOutUp")}))},400)}}})}}function cspm_infobox_set_position(e,s,a,t){var r=e.gmap3("get"),o=Math.pow(2,r.getZoom()),i=new google.maps.LatLng(r.getBounds().getNorthEast().lat(),r.getBounds().getSouthWest().lng()),_=r.getProjection().fromLatLngToPoint(i),n=r.getProjection().fromLatLngToPoint(a),p=new google.maps.Point(Math.floor((n.x-_.x)*o),Math.floor((n.y-_.y)*o)),c=e.position(),l=s.width()/2,m=t+s.height();s.css({left:p.x+c.left+"px",top:p.y+c.top+"px","margin-left":"-"+l+"px","margin-top":"-"+m+"px"}).fadeIn("slow")}function cspm_nbr_of_visible_markers(e){var s=0;return e.gmap3({get:{name:"marker",all:!0,callback:function(e){for(var a=0;a<e.length;a++)1==e[a].visible&&s++}}}),s}function cspm_hide_all_markers(e){var s=jQuery.Deferred();return e.gmap3({get:{name:"marker",all:!0,callback:function(e){jQuery.each(e,function(e,s){"function"==typeof s.setVisible&&"user_location"!=s.post_id&&s.setVisible(!1)}),s.resolve()}}}),s}function cspm_remove_array_duplicates(e){var s=[],a=0;return jQuery.each(e,function(e,t){-1===jQuery.inArray(t,s)&&(s[a]=t,a++)}),s}function cspm_object_size(e){var s,a=0;for(s in e)e.hasOwnProperty(s)&&a++;return a}function cspm_strpos(e,s,a){var t=(e+"").indexOf(s,a||0);return-1===t?!1:t}function cspm_deg2rad(e){return.017453292519943295*e}function alerte(e){if("object"==typeof e){var s="";for(var a in e)e.hasOwnProperty(a)&&(s+="["+a+"] => "+e[a]+"\n");alert(s)}else alert(e)}window.cspm_global_object={};var carousel_map_zoom=progress_map_vars.carousel_map_zoom,map_layout={},post_ids_and_categories={},post_lat_lng_coords={},post_ids_and_child_status={},cspm_requests={},cspm_bubbles={},cspm_child_markers={};jQuery(document).ready(function(e){var s={};if(cspm_global_object.posts_to_retrieve={},"true"==progress_map_vars.faceted_search_option){if("function"==typeof e("form.faceted_search_form input").iCheck)if("line"==progress_map_vars.faceted_search_input_skin){var a="black"!=progress_map_vars.faceted_search_input_color?"-"+progress_map_vars.faceted_search_input_color:"";e("form.faceted_search_form input").each(function(){var s=e(this),t=s.next(),r=t.text();t.remove(),s.iCheck({checkboxClass:"icheckbox_line"+a,radioClass:"iradio_line"+a,insert:'<div class="icheck_line-icon"></div>'+r,inheritClass:!0})})}else{if("polaris"!=progress_map_vars.faceted_search_input_skin&&"futurico"!=progress_map_vars.faceted_search_input_skin)var a="black"!=progress_map_vars.faceted_search_input_color?"-"+progress_map_vars.faceted_search_input_color:"";else var a="";e("form.faceted_search_form input").iCheck({checkboxClass:"icheckbox_"+progress_map_vars.faceted_search_input_skin+a,radioClass:"iradio_"+progress_map_vars.faceted_search_input_skin+a,increaseArea:"20%",inheritClass:!0})}e("div.faceted_search_btn").livequery("click",function(){var s=e(this).attr("id");e("div.faceted_search_container_"+s).is(":visible")?(e("div.faceted_search_container_"+s).removeClass("slideInLeft").addClass("cspm_animated slideOutLeft"),setTimeout(function(){e("div.faceted_search_container_"+s).css({display:"none"})},200)):e("div.faceted_search_container_"+s).removeClass("slideOutLeft").addClass("cspm_animated fadeInRight").css({display:"block"}),"function"==typeof jQuery("div.cluster_posts_widget_"+s).mCustomScrollbar&&(e("div[class^=faceted_search_container] form.faceted_search_form ul").mCustomScrollbar("destroy"),e("div[class^=faceted_search_container] form.faceted_search_form ul").mCustomScrollbar({autoHideScrollbar:!1,mouseWheel:{enable:!0,preventDefault:!0},theme:"dark-thin"}))}),e("div[class^=reset_map_list]").livequery("click",function(){var s=e(this).attr("id"),a=e("form#faceted_search_form_"+s+" input");"function"==typeof a.iCheck&&a.iCheck("uncheck"),e(this).hide()});var t="function"==typeof e("form.faceted_search_form input").iCheck?"ifChanged":"change";e("form.faceted_search_form input").livequery(t,function(){var a=e(this).attr("data-map-id"),t=e(this).attr("data-show-carousel"),r=e("div#codespacing_progress_map_div_"+a);"undefined"!=typeof NProgress&&(NProgress.configure({parent:"div#codespacing_progress_map_div_"+a,showSpinner:!0}),NProgress.start()),cspm_hide_all_markers(r).done(function(){"undefined"!=typeof NProgress&&NProgress.set(.5),"false"==progress_map_vars.faceted_search_multi_taxonomy_option&&e("div.reset_map_list_"+a).show(),s[a]=[];var o=[],i=0,_=0,n=0,p=0;if(e("div.faceted_search_container_"+a+" form.faceted_search_form input").each(function(){if(1==e(this).prop("checked")){n++;var t=e(this).val();o=cspm_remove_array_duplicates(o.concat(cspm_set_markers_visibility(r,a,t,_,post_ids_and_categories[a],s[a],!0))),cspm_simple_clustering(r,a),i++}}),0==n){var _=0;cspm_set_markers_visibility(r,a,null,_,post_ids_and_categories[a],s[a],!1),cspm_simple_clustering(r,a)}var c=p=cspm_object_size(s[a]);if("yes"==progress_map_vars.faceted_search_drag_map&&c>0){var l=post_lat_lng_coords[a][s[a][0]].split("_");cspm_center_map_at_point(r,l[0],l[1],"zoom")}cspm_global_object.posts_to_retrieve[a]=s[a],"yes"==progress_map_vars.show_posts_count&&e("span.the_count_"+a).empty().html(p),setTimeout(function(){cspm_rewrite_carousel(a,t,s[a])},500),"undefined"!=typeof NProgress&&NProgress.done()})})}e("div.cspm_infobox_container[data-move-carousel=true] div.cspm_infobox_content_container").livequery("mouseenter",function(){var s=e(this).attr("data-map-id"),a=e(this).attr("data-post-id"),t=e(this).attr("data-show-carousel"),r=e("ul[id^=codespacing_progress_map_carousel_] li[id="+s+"_list_items_"+a+"]").attr("value");"yes"==t&&cspm_call_carousel_item(e("ul#codespacing_progress_map_carousel_"+s).data("jcarousel"),r)}),"true"==progress_map_vars.show_carousel&&e("ul[id^=codespacing_progress_map_carousel_] li").livequery("click",function(){var s=e(this).attr("data-map-id");if("fullscreen-map"!=map_layout[s]&&"fit-in-map"!=map_layout[s]){var a=e(this).attr("value");cspm_call_carousel_item(e("ul#codespacing_progress_map_carousel_"+s).data("jcarousel"),a);var t=e("ul#codespacing_progress_map_carousel_"+s).data("jcarousel");cspm_carousel_item_request(t,parseInt(a))}}).css("cursor","pointer"),"true"==progress_map_vars.search_form_option&&("function"==typeof e("input.cspm_sf_slider_range").ionRangeSlider&&e("input.cspm_sf_slider_range").ionRangeSlider({type:"single",grid:!0}),e("div.search_form_btn").livequery("click",function(){var s=e(this).attr("id");e("div.search_form_container_"+s).is(":visible")?(e("div.search_form_container_"+s).removeClass("fadeInUp").addClass("cspm_animated slideOutLeft"),setTimeout(function(){e("div.search_form_container_"+s).css({display:"none"})},200)):(e("div.search_form_container_"+s).removeClass("slideOutLeft").addClass("cspm_animated fadeInUp").css({display:"block"}),setTimeout(function(){e("form#search_form_"+s+" input[name=cspm_address]").focus()},400))}),e("div[class^=cspm_submit_search_form_]").livequery("click",function(){var s=e(this).attr("data-map-id");"undefined"!=typeof NProgress&&(NProgress.configure({parent:"div#codespacing_progress_map_div_"+s,showSpinner:!0}),NProgress.start());var a=e(this).attr("data-show-carousel"),t=progress_map_vars.before_search_address+e("form#search_form_"+s+" input[name=cspm_address]").val()+progress_map_vars.after_search_address,r=e("form#search_form_"+s+" input[name=cspm_distance]").val(),o=e("form#search_form_"+s+" input[name=cspm_distance_unit]").val(),i=e("div.cspm_infobox_container.cspm_infobox_"+s),_=e("div.codespacing_progress_map_area").attr("data-show-infobox"),n=e("div.codespacing_progress_map_area").attr("data-infobox-display-event"),p=e("div#codespacing_progress_map_div_"+s),c={};c[s]=[];var l=new google.maps.Geocoder;l.geocode({address:t},function(t,l){if(l==google.maps.GeocoderStatus.OK){var m=t[0].geometry.location.lat(),u=t[0].geometry.location.lng();p.gmap3({get:{name:"marker",all:!0,callback:function(t){var l=0;e.each(t,function(e,a){var t=a.id,i=a.position;cspm_get_distance(m,u,i.lat(),i.lng(),o)<parseInt(r)&&(c[s][l]=parseInt(t),l++)}),cspm_object_size(c[s])>0?cspm_hide_all_markers(p).done(function(){cspm_center_map_at_point(p,m,u,"zoom"),cspm_set_markers_visibility(p,s,null,0,post_ids_and_categories[s],c[s],!0),cspm_simple_clustering(p,s),cspm_global_object.posts_to_retrieve[s]=c[s],p.gmap3({clear:{tag:"search_circle",all:!0},circle:{tag:"search_circle",options:{center:[m,u],radius:1e3*parseInt(r),fillColor:progress_map_vars.fillColor,fillOpacity:progress_map_vars.fillOpacity,strokeColor:progress_map_vars.strokeColor,strokeOpacity:progress_map_vars.strokeOpacity,strokeWeight:parseInt(progress_map_vars.strokeWeight),editable:!1},callback:function(e){p.gmap3("get").fitBounds(e.getBounds())},events:{click:function(){"true"==_&&"onload"!=n&&(i.addClass("cspm_animated fadeOutUp"),i.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){i.hide().removeClass("cspm_animated fadeOutUp")}))}}}}),e("div.cspm_reset_search_form_"+s).show(),"yes"==progress_map_vars.show_posts_count&&e("span.the_count_"+s).empty().html(c[s].length),setTimeout(function(){cspm_rewrite_carousel(s,a,c[s])},500)}):(e("div.search_form_container_"+s+" div.cspm_search_form_notice").removeClass("fadeOut").addClass("cspm_animated fadeInLeft").css({display:"block"}),setTimeout(function(){e("div.search_form_container_"+s+" div.cspm_search_form_notice").removeClass("fadeInLeft").addClass("cspm_animated fadeOut"),setTimeout(function(){e("div.search_form_container_"+s+" div.cspm_search_form_notice").css({display:"none"})},700)},5e3))}}})}else e("div.search_form_container_"+s+" div.cspm_search_form_error").removeClass("fadeOut").addClass("cspm_animated fadeInLeft").css({display:"block"}),setTimeout(function(){e("div.search_form_container_"+s+" div.cspm_search_form_error").removeClass("fadeInLeft").addClass("cspm_animated fadeOut"),setTimeout(function(){e("div.search_form_container_"+s+" div.cspm_search_form_error").css({display:"none"})},700)},5e3);"undefined"!=typeof NProgress&&NProgress.done()})}),e("div[class^=cspm_reset_search_form]").livequery("click",function(){var a=e(this).attr("data-map-id");"undefined"!=typeof NProgress&&(NProgress.configure({parent:"div#codespacing_progress_map_div_"+a,showSpinner:!0}),NProgress.start());var t=e(this).attr("data-show-carousel"),r=e("div#codespacing_progress_map_div_"+a);s[a]=[],cspm_set_markers_visibility(r,a,null,0,post_ids_and_categories[a],s[a],!1),cspm_simple_clustering(r,a),
cspm_global_object.posts_to_retrieve[a]=s[a],"yes"==progress_map_vars.show_posts_count&&e("span.the_count_"+a).empty().html(s[a].length),"undefined"!=typeof NProgress&&NProgress.set(.5),r.gmap3({clear:{tag:"search_circle",all:!0}}),e("form#search_form_"+a+" input#cspm_address_"+a).attr("value","").focus(),setTimeout(function(){cspm_rewrite_carousel(a,t,s[a])},500),e(this).removeClass("fadeIn").hide("fast",function(){"undefined"!=typeof NProgress&&NProgress.done()})})),e("div.toggle-carousel-bottom, div.toggle-carousel-top").livequery("click",function(){var s=e(this).attr("data-map-id");e("div#codespacing_progress_map_carousel_container[data-map-id="+s+"]").slideToggle("slow",function(){cspm_init_carousel(null,s)})}),e("span.cspm_distance").livequery("click",function(){var s=e(this).attr("data-map-id");e("form#search_form_"+s+" div.cspm_search_distances ul").is(":visible")?(e("form#search_form_"+s+" div.cspm_search_distances ul").removeClass("fadeInDown").addClass("cspm_animated fadeOutUp"),setTimeout(function(){e("form#search_form_"+s+" div.cspm_search_distances ul").css({display:"none"})},200)):e("form#search_form_"+s+" div.cspm_search_distances ul").removeClass("fadeOutUp").addClass("cspm_animated fadeInDown").css({display:"block"})}),e("div.cspm_search_distances ul li").livequery("click",function(){var s=e(this).parent().prev().attr("data-map-id");e("form#search_form_"+s+" div.cspm_search_distances span.cspm_distance").text(e(this).text()),e("form#search_form_"+s+" div.cspm_search_distances ul").removeClass("fadeInDown").addClass("cspm_animated fadeOutUp"),setTimeout(function(){e("form#search_form_"+s+" div.cspm_search_distances ul").css({display:"none"})},200)}),e("button#cspm_search_btn").livequery("click",function(){var s=e(this).attr("data-map-id"),a=e("input[name=cspm_search_address]").val(),t=e("div#cspm_frontend_form_"+s);t.gmap3({clear:{name:"marker",all:!0}});var r=new google.maps.Geocoder;r.geocode({address:a},function(e,s){if(s==google.maps.GeocoderStatus.OK){var a=e[0].geometry.location.lat(),r=e[0].geometry.location.lng();setTimeout(function(){cspm_center_map_at_point(t,a,r,"zoom"),t.gmap3({marker:{latLng:e[0].geometry.location,options:{draggable:!0}}})},500)}})}),e("input#cspm_search_address").keypress(function(e){13==e.keyCode&&e.preventDefault()}),e("button#cspm_get_pinpoint").livequery("click",function(){var s=e(this).attr("data-map-id"),a=e("div#cspm_frontend_form_"+s);a.gmap3({get:{name:"marker",callback:function(s){s&&(e("input#cspm_latitude").val(s.getPosition().lat()),e("input#cspm_longitude").val(s.getPosition().lng()))}}})}),e("div[class^=codespacing_map_geotarget]").livequery("click",function(){var s=e(this).attr("data-map-id"),a=e("div#codespacing_progress_map_div_"+s);cspm_geolocate(a,s,!1,"",0,progress_map_vars.user_map_zoom,!0)})});